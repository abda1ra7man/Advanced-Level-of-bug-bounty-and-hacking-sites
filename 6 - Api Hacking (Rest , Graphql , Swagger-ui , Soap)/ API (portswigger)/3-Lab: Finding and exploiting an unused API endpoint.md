
---

# حل لاب Burp Suite - تعديل السعر عبر PATCH Method

## المقدمة
الهدف من اللاب ده هو استغلال ثغرة في API التطبيق باستخدام Burp Suite لتعديل بيانات المنتجات، تحديدًا سعر المنتج. هنشوف إزاي ممكن نتلاعب بطلبات الـ API عشان نغير سعر منتج من خلال تغيير الـ HTTP method.

## الخطوات

### 1. **الوصول إلى المنتج في Burp's browser**
- افتح Burp Suite واستخدم المتصفح المدمج فيه للوصول إلى التطبيق.
- اختر أي منتج في التطبيق.

### 2. **استعراض الطلبات في HTTP History**
- اذهب إلى **Proxy > HTTP History** وراقب الطلبات الخاصة بالـ API مثل:
  ```
  /api/products/3/price
  ```

### 3. **إرسال الطلب إلى Repeater**
- اضغط بالزر الأيمن على الطلب الخاص بالـ API واختر **Send to Repeater**.

### 4. **تغيير الـ HTTP Method إلى OPTIONS**
- في تبويب **Repeater**، غير الـ HTTP method من **GET** إلى **OPTIONS**، ثم أرسل الطلب.
- ستلاحظ في الاستجابة أن الطرق المدعومة هي **GET** و **PATCH**.

### 5. **تغيير الـ HTTP Method إلى PATCH**
- غير الـ HTTP method من **GET** إلى **PATCH**، ثم أرسل الطلب.
- ستلاحظ أنك تحصل على رسالة **Unauthorized**، مما يعني أنك بحاجة لتسجيل الدخول أولًا.

### 6. **تسجيل الدخول باستخدام بيانات الاعتماد**
- في Burp's browser، قم بتسجيل الدخول باستخدام بيانات الاعتماد:
  ```
  wiener:peter
  ```

### 7. **اختيار المنتج "l33t" Leather Jacket**
- اختر منتج **Lightweight "l33t" Leather Jacket**.

### 8. **استعراض الطلبات في HTTP History مرة تانية**
- في **Proxy > HTTP History**، ابحث عن الطلب الخاص بالمنتج:
  ```
  /api/products/1/price
  ```
- اضغط بالزر الأيمن على الطلب واختر **Send to Repeater**.

### 9. **تغيير الـ HTTP Method إلى PATCH**
- في تبويب **Repeater**، غير الـ HTTP method من **GET** إلى **PATCH** ثم أرسل الطلب.
- ستلاحظ ظهور خطأ بسبب **Content-Type** الغير صحيح.

### 10. **إضافة رأس Content-Type**
- أضف رأس **Content-Type** في الطلب وحدد قيمته إلى:
```http                                                             
PATCH /api/products/3/price HTTP/2                                 
Host: 0aea00b004c3d0ff818bcf21001a00bd.web-security-academy.net     
Content-Type: application/json                                      

```

### 11. **إضافة جسم JSON فارغ**
- أضف جسم JSON فارغ `{}` في الطلب، ثم أرسل الطلب.
- ستلاحظ ظهور خطأ بسبب نقص معلمة `price` في جسم الطلب.
### Request:
```http                                                             
PATCH /api/products/3/price HTTP/2                              
Host: 0aea00b004c3d0ff818bcf21001a00bd.web-security-academy.net     
Content-Type: application/json                  
                    
{}                                                                   
```
### Response:
```json                                                             
{"type":"ClientError","code":400,"error":"'price' parameter missing in body"}                                                                
```
### 12. **إضافة معلمة price مع القيمة 0**
- أضف معلمة `price` في الجسم كالتالي:
### Request:
```http                                                             
PATCH /api/products/3/price HTTP/2                              
Host: 0aea00b004c3d0ff818bcf21001a00bd.web-security-academy.net     
Content-Type: application/json                  
                    
{
"price":0
}                                                                   
```
### Response:
```json                                                             
{"price":"$0.00"}
```
- أرسل الطلب ولاحظ أن السعر قد تم تعديله.

### 13. **إعادة تحميل صفحة المنتج**
- في Burp's browser، قم بإعادة تحميل صفحة المنتج **Leather Jacket**.
- ستلاحظ أن السعر قد تغير إلى **$0.00**.

### 14. **إضافة المنتج إلى السلة**
- أضف المنتج إلى السلة.

### 15. **إتمام عملية الشراء**
- اذهب إلى سلتك واضغط على **Place order** لحل اللاب.

---

## الخاتمة
اللاب ده بيورينا إزاي نقدر نستخدم Burp Suite لاكتشاف الثغرات في الـ API وتعديل البيانات من خلال تغيير الـ HTTP method. بخصوص هذا المثال، استغلينا الـ PATCH method لتغيير سعر المنتج وإتمام عملية الشراء.

---
